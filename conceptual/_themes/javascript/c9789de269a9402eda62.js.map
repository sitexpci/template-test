{"version":3,"sources":["webpack:///./docs.azureselector.js","webpack:///./docs.branchselector.js","webpack:///./commenting.js","webpack:///./experiment.js","webpack:///./insight.js","webpack:///./trace.js","webpack:///./errors.js","webpack:///./rating.js"],"names":[],"mappings":";;;;;iEAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,wBAAwB;AACxC,iBAAgB,wBAAwB;AACxC,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA4C,mBAAmB;AAC/D,wCAAuC,kCAAkC;;AAEzE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6HAA4H;AAC5H,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+DAA8D,gCAAgC,EAAE;AAChG,+DAA8D,iCAAiC,EAAE;AACjG;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;;;iECvJD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA,EAAC;;;;;;;;;ACtDD,uE,+CAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL,E;kEAAC,G;;;;;;;AC3BD;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA,4BAA2B,aAAa;AACxC;;AAEA,6EAA4E,YAAY,gCAAgC;AACxH;;AAEA;AACA,2EAA0E;AAC1E,wBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAwB;AACxB;AACA;AACA,yBAAwB;AACxB;AACA;AACA,yBAAwB;AACxB;AACA;AACA,yBAAwB;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,MAAK;AACL;AACA;AACA;AACA;AACA,EAAC;;;;;;;;;AClJD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,qBAAqB;AAChD;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+E,+CAAA;AACA;AACA,U;kEAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA,EAAC,I;;;;;;;;4EC/UD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,uJ;;;;;;;;4EC9ED;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAC,uJ;;;;;;;;AClED;AACA;AACA;AACA;AACA;AACA;AACA,G","file":"c9789de269a9402eda62.js","sourcesContent":["/**\r\n * The Azure Selector component of the DOCS website.\r\n * Azure Selector is a component consists of one or two dropdowns displayed inline. When all of the dropdowns has a valid\r\n * value, the website will jump to the target page. If the user selects a value in one of the dropdown, the other dropdown\r\n * will also populate all the available values accordign the first selected one.\r\n *\r\n * Dependencies:\r\n *     - urijs: Find the current selected item by comparing the URLs\r\n *     - docs.mainframe: Construct/Manipulate Azure DOM elements\r\n */\r\n\r\ndefine([\"urijs\", \"docs.mainframe\"], function(URI, mainframe) {\r\n    \"use strict\";\r\n\r\n    // I will do a unified implementation of the Azure Selector for both one-dropdown and two-dropdowns.\r\n    // For the single azure selector, the input HTML would like to be:\r\n    // <div class=\"op_single_selector\">\r\n    //   <ul>\r\n    //     <li><a href=\"../a1.html\">A1</a></li>\r\n    //     <li><a href=\"../a2.html\">A2</a></li>\r\n    //     <li><a href=\"../a3.html\">A3</a></li>\r\n    //   </ul>\r\n    // </div>\r\n    //\r\n    // For the double azure selectors, the input HTML would look like:\r\n    // <div class=\"op_multi_selector\" title1=\"First Opt\" title2=\"Second Opt\">\r\n    //   <ul>\r\n    //     <li><a href=\"../c1.html\">(A1 | B1)</a></li>\r\n    //     <li><a href=\"../c2.html\">(A1 | B2)</a></li>\r\n    //     <li><a href=\"../c3.html\">(A2 | B1)</a></li>\r\n    //     <li><a href=\"../c4.html\">(A2 | B3)</a></li>\r\n    //     <li><a href=\"../c5.html\">(A3 | B1)</a></li>\r\n    //     <li><a href=\"../c6.html\">(A3 | B2)</a></li>\r\n    //     <li><a href=\"../c7.html\">(A3 | B3)</a></li>\r\n    //   </ul>\r\n    // </div>\r\n\r\n    /**\r\n     * First of all, we need to generate a Dictionary of the available options. For example, the mapping table of the single azure selector should be like:\r\n     * {\r\n     *     A1: { default: \"../a1.html\" },\r\n     *     A2: { default: \"../a2.html\" },\r\n     *     A3: { default: \"../a3.html\" }\r\n     * }\r\n     * But the mapping table for the double azure selectors would be a little bit compilicated:\r\n     * {\r\n     *     A1: {\r\n     *         B1: \"../c1.html\",\r\n     *         B2: \"../c2.html\"\r\n     *     }\r\n     *     A2: {\r\n     *         B1: \"../c3.html\",\r\n     *         B3: \"../c4.html\"\r\n     *     },\r\n     *     A3: {\r\n     *         B1: \"../c5.html\",\r\n     *         B2: \"../c6.html\",\r\n     *         B3: \"../c7.html\"\r\n     *     }\r\n     * }\r\n     */\r\n    function generateOptionsMap(selectorDivElement, isSingleSelector) {\r\n        var optionsMap = {};\r\n        mainframe.getAzureSelectorAnchors(selectorDivElement).each(function () {\r\n            if ($(this) && $(this).text()) {\r\n                var contents = (isSingleSelector ? [$(this).text(), \"default\"] : $(this).text().trim().slice(1, -1).split(\"|\"));\r\n                if (contents.length === 2) {\r\n                    var firstOption = contents[0].trim();\r\n                    var secondOption = contents[1].trim();\r\n                    var targetLink = $(this).attr(\"href\");\r\n                    if (firstOption && secondOption && targetLink) {\r\n                        if (!optionsMap[firstOption]) {\r\n                            optionsMap[firstOption] = {};\r\n                        }\r\n                        optionsMap[firstOption][secondOption] = targetLink;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return optionsMap;\r\n    }\r\n\r\n    /**\r\n     * Get the current selected options from the optionsMap and return a two-element tuple. For the single selector, the second option is always \"default\".\r\n     */\r\n    function getCurrentSelectedOptions(optionsMap, isSingleSelector) {\r\n        var browserUrlString = window.location.href.toLowerCase();\r\n        for (var mainOptionValue in optionsMap) {\r\n            for (var secondaryOptionValue in optionsMap[mainOptionValue]) {\r\n                var targetUrlString = optionsMap[mainOptionValue][secondaryOptionValue].toLowerCase();\r\n                if (URI(targetUrlString, browserUrlString).equals(browserUrlString)) {\r\n                    return [mainOptionValue, secondaryOptionValue];\r\n                }\r\n            }\r\n        }\r\n        return [null, null];\r\n    }\r\n\r\n    /**\r\n     * Next, one or two dropdowns are need to be created according to the generated optionsMap. The dropdowns are differentiate by main and secondary.\r\n     * The secondary dropdown's availble options will always be populated according to the main dropdown's current selection (If no item is selected, just\r\n     * make the secondary dropdown's availble options to empty).\r\n     */\r\n    function createDropdowns(selectorDivElement, isSingleSelector) {\r\n\r\n        function dropdownItemTemplate(key) { return [key, key]; }\r\n        function jumpToUrl(targetUrl) { window.location.href = targetUrl; }\r\n\r\n        var optionsMap = generateOptionsMap(selectorDivElement, isSingleSelector);\r\n        var selectedOptions = getCurrentSelectedOptions(optionsMap, isSingleSelector);\r\n\r\n        var container = mainframe.createAzureSelectorsContainer();\r\n        var firstDropdown = mainframe.createAzureSelectorDropdown(container, selectorDivElement.attr(\"title1\"));\r\n        var secondDropdown = null;\r\n        mainframe.populateDropdownOptions(firstDropdown, optionsMap, dropdownItemTemplate);\r\n        firstDropdown.val(selectedOptions[0]);\r\n        if (!isSingleSelector) {\r\n            secondDropdown = mainframe.createAzureSelectorDropdown(container, selectorDivElement.attr(\"title2\"));\r\n            firstDropdown.change(function () {\r\n                mainframe.populateDropdownOptions(secondDropdown, firstDropdown.val() ? optionsMap[firstDropdown.val()] : {}, dropdownItemTemplate);\r\n            });\r\n            secondDropdown.change(function () {\r\n                if (firstDropdown.val() && secondDropdown.val()) {\r\n                    jumpToUrl(optionsMap[firstDropdown.val()][secondDropdown.val()]);\r\n                }\r\n            });\r\n            firstDropdown.change();\r\n            secondDropdown.val(selectedOptions[1]);\r\n        } else {\r\n            firstDropdown.change(function () {\r\n                if (firstDropdown.val()) {\r\n                    jumpToUrl(optionsMap[firstDropdown.val()][\"default\"]);\r\n                }\r\n            });\r\n        }\r\n\r\n        selectorDivElement.replaceWith(container);\r\n    }\r\n\r\n    /**\r\n     * This function will convert both the Azure Single Selector as well as the Azure Double Selector HTMLs to the corresponding dropdown within the text.\r\n     * @returns void\r\n     */\r\n    function renderAzureSelectors() {\r\n        mainframe.getSingleAzureSelectors().each(function () { createDropdowns($(this), true); });\r\n        mainframe.getDoubleAzureSelectors().each(function () { createDropdowns($(this), false); });\r\n    }\r\n\r\n    return {\r\n        renderAzureSelectors: renderAzureSelectors\r\n    };\r\n});\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./docs.azureselector.js\n ** module id = 19\n ** module chunks = 1\n **/","/**\r\n * The Branch Selector component of the DOCS website\r\n *\r\n * Dependencies:\r\n *     - cookies: Read and write cookies to the website\r\n *     - urijs: Parse and append query string to the current URL\r\n *     - docs.mainframe: Construct/Manipulate selector DOM elements\r\n */\r\ndefine([\"cookies\", \"urijs\", \"docs.utilities\",  \"docs.mainframe\"], function(cookies, URI, utilities, mainframe) {\r\n    \"use strict\";\r\n\r\n    function isInTestEnvironment() {\r\n        return !!cookies.getCookie(\"AppServiceAuthSession\");\r\n    }\r\n\r\n    function getAvailableBranchesAsync() {\r\n        try {\r\n            var windowUrl = URI(window.location.href);\r\n            var baseUrlString = URI(window.location.href).origin();\r\n            var apiUrlString = \"/_api/branches?docPath=\" + encodeURIComponent(windowUrl.pathname());\r\n            var apiUrl = URI(apiUrlString, baseUrlString);\r\n            return utilities.loadJsonFileAsync(apiUrl.toString());\r\n        } catch (err) {\r\n            return $.when(null);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Renders the branch selector if it is in the DEVINT or SANBOX environment.\r\n     * @returns {JQueryPromise} An async operation which represents the process of contructing the branch selector\r\n     */\r\n    function renderBranchSelectorAsync() {\r\n        if (!isInTestEnvironment()) {\r\n            return $.when();\r\n        }\r\n        return getAvailableBranchesAsync().done(function (branches) {\r\n            if (branches && branches.length) {\r\n                var dropdown = mainframe.createBranchSelectorDropdown(branches);\r\n                dropdown.change(function () {\r\n                    var targetBranchName = dropdown.val();\r\n                    if (targetBranchName) {\r\n                        cookies.setCookie(\"CONTENT_BRANCH\", targetBranchName);\r\n                        window.location.href = URI(window.location.href).search(\"branch=\" + targetBranchName).toString();\r\n                    }\r\n                });\r\n                dropdown.val(cookies.getCookie(\"CONTENT_BRANCH\"));\r\n                mainframe.appendToSocialActions(dropdown);\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        renderBranchSelectorAsync: renderBranchSelectorAsync\r\n    };\r\n});\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./docs.branchselector.js\n ** module id = 20\n ** module chunks = 1\n **/","require([\"docs.config\", \"commenting-callback\"], function (config, callbacks) {\r\n    $script([config.paths.livefyre, config.paths.opencomment], function () {\r\n        \"use strict\";\r\n\r\n        //commenting configurations.\r\n        var commentOptions = {\r\n            network: \"microsoft-int-0.fyre.co\",\r\n            siteId: \"306034\",\r\n            containerElementId: \"comments-container\",\r\n            documentIdMetaName: \"ms.assetid\",\r\n            sidenoteSelectors: {\r\n                include: \"p\",\r\n                exclude: \"div.fyre-editor-editable p, div.fyre-comment p, div.button p, div.step-by-step p\"\r\n            },\r\n            localeMetaName: \"ms.locale\",\r\n            theme: \"docs\",\r\n            commentCallback: function (commentsWidget) {\r\n                callbacks.resolve(\"comment-init\", commentsWidget);\r\n            },\r\n            sidenoteCallback: function (sidenotesWidget) {\r\n                callbacks.resolve(\"sidenote-init\", sidenotesWidget)\r\n            }\r\n        };\r\n\r\n        // load commenting widget\r\n        opencomment(commentOptions);\r\n    });\r\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./commenting.js\n ** module id = 21\n ** module chunks = 1\n **/","/* Sample:\r\n    Experiment.IsEnabledAsync('experiment_name').done(function(fEnabled){\r\n        if (fEnabled) {\r\n            // do something, in case the experiment is ON for this specific session\r\n        } else {\r\n            // do something else, in case the experiment is OFF for this specific session\r\n        }\r\n    });\r\n*/\r\n\r\n// jshint ignore:start\r\nwindow.Experiment = new(function(){\r\n    var root = (function(){return this;}).call(null);\r\n    var _ = this;\r\n\r\n    var m_objConfigurationPromise = root.NinjaMode ? $.Deferred().resolve({}) : $.ajax({url: '/_chrome/experiment.json'});\r\n    _.m_objConfiguration = null;\r\n\r\n    _.GetCookie = function(name) {\r\n        var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];\r\n        for (var i = 0; i < cookies.length; i++) {\r\n            var pos = cookies[i].indexOf('=');\r\n            if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))\r\n            {\r\n                var cookie = cookies[i].slice(pos + 1).replace(/\\+/g, ' ');\r\n                cookie = root.decodeURIComponent(cookie);\r\n                return cookie;\r\n            }\r\n        }\r\n    };\r\n\r\n    _.GetHashCode = function(input) {\r\n        var result = 0;\r\n        if (input) {\r\n            for (var i = 0; i < input.length; i++) {\r\n                var c = input.charCodeAt(i);\r\n                result = ((result << 5) - result) + c;\r\n                result = result & result;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    _.GetConfigurationAsync = function() {\r\n        if (_.m_objConfiguration !== null) {\r\n            return $.Deferred().resolve(_.m_objConfiguration);\r\n        }\r\n        return m_objConfigurationPromise;\r\n    };\r\n\r\n    _.GetCustomSettings = function() {\r\n        var result = _.GetCookie('EXP');\r\n        result = result && _.JsonDeserialize(result);\r\n        return result;\r\n    };\r\n\r\n    var IsEnabledInternal = function(experimentName, configuration) {\r\n        try {\r\n            var customSettings = _.GetCustomSettings();\r\n            if (customSettings && customSettings.hasOwnProperty(experimentName)) {\r\n                return Boolean(customSettings[experimentName]);\r\n            }\r\n            if (!configuration) {\r\n                return false;\r\n            }\r\n            var experimentSetting = configuration[experimentName];\r\n            if (experimentSetting) {\r\n                if (!experimentSetting['enabled']) {\r\n                    return false;\r\n                }\r\n                var experimentRatio = experimentSetting['ratio'];\r\n                if (experimentRatio <= 0)\r\n                {\r\n                    return false;\r\n                }\r\n                if (experimentRatio >= 100)\r\n                {\r\n                    return true;\r\n                }\r\n                var sessionId = _.GetCookie('SID');\r\n                if (!sessionId) {\r\n                    return false;\r\n                }\r\n                var hash = _.GetHashCode(sessionId + ':' + experimentName);\r\n                if (hash == -2147483648)\r\n                {\r\n                    hash = 0;\r\n                }\r\n                if (hash < 0)\r\n                {\r\n                    hash = -hash;\r\n                }\r\n                return hash < root.Math.floor(2147483647 / 100) * experimentRatio;\r\n            }\r\n        } catch (ex) {\r\n            // do nothing\r\n        }\r\n        return false;\r\n    };\r\n\r\n    _.IsEnabledAsync = function(experimentName) {\r\n        return _.GetConfigurationAsync().then(function(configuration) {\r\n            return $.Deferred().resolve(IsEnabledInternal(experimentName, configuration));\r\n        }, function() {\r\n            return $.Deferred().resolve(IsEnabledInternal(experimentName));\r\n        });\r\n    };\r\n\r\n    _.JsonDeserialize = function(content) {\r\n        return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();\r\n    };\r\n\r\n    _.SetCookie = function(name, value, options) {\r\n        var cookie = root.encodeURIComponent(name) + '=' + root.encodeURIComponent(value);\r\n        options = options || {};\r\n\r\n        if (typeof options.expires === 'number' || options.expires instanceof Number) {\r\n            var milliseconds = options.expires * 86400 * 1000;\r\n            options.expires = new Date();\r\n            options.expires.setTime(Number(options.expires) + milliseconds);\r\n        }\r\n\r\n        if (options.expires) {\r\n            cookie += '; expires=' + options.expires.toUTCString();\r\n        }\r\n        if (options.path) {\r\n            cookie += '; path=' + options.path;\r\n        }\r\n        if (options.domain) {\r\n            cookie += '; domain=' + options.domain;\r\n        }\r\n        if (options.secure) {\r\n            cookie += '; secure';\r\n        }\r\n        return root.document.cookie = cookie;\r\n    };\r\n\r\n    try {\r\n        root.AmbientContext = _.GetCookie('AmbientContext');\r\n        root.AmbientContext = root.AmbientContext && _.JsonDeserialize(root.AmbientContext);\r\n    } catch(ex) {\r\n    } finally {\r\n        root.AmbientContext = root.AmbientContext || {};\r\n        root.AmbientContext['EXP'] = _.GetCustomSettings();\r\n        root.AmbientContext['SID'] = _.GetCookie('SID');\r\n    }\r\n})();\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./experiment.js\n ** module id = 25\n ** module chunks = 1 5 7\n **/","(function(){\r\n    \"use strict\";\r\n\r\n    var Trace = require(\"trace\");\r\n\r\n    if (window.insight) {\r\n        Trace.traceError(\"insight.js is loaded more than once.\");\r\n        return;\r\n    }\r\n    var insight = {};\r\n\r\n    insight.debugConsoleLogEnabled = false;\r\n    insight.debugLogMsgs = [];\r\n    insight.debugLog = function (inMsg) {\r\n        insight.debugLogMsgs.push(inMsg);\r\n        if (insight.debugConsoleLogEnabled) {\r\n            console.log(inMsg);\r\n        }\r\n    };\r\n    //Common function to fire custom event on clicked element\r\n    insight.processWEDCSCustomEventFromArray = function (inArray) {\r\n        if (typeof window.MscomCustomEvent !== \"function\") {\r\n            return;\r\n        } else if (!inArray || inArray.length === 0) {\r\n            window.MscomCustomEvent();\r\n            return;\r\n        }\r\n        window.MscomCustomEvent.apply(this, inArray);\r\n    };\r\n    ////////////////////// ERROR RELATED\r\n    var formatErrorObjectToWedcsArray = function (errorObject) {\r\n        var array = [];\r\n        if (!errorObject) {\r\n            return array;\r\n        }\r\n        if (errorObject.error) {\r\n            array.push(\"ms.error\", errorObject.error.toString().substring(0, 100));\r\n        }\r\n        if (errorObject.message) {\r\n            array.push(\"ms.errormsg\", errorObject.message.substring(0, 30));\r\n        }\r\n        if (errorObject.source) {\r\n            array.push(\"ms.errorsrc\", errorObject.source);\r\n        }\r\n        if (errorObject.lineno) {\r\n            array.push(\"ms.errorlineno\", errorObject.lineno);\r\n        }\r\n        if (errorObject.colno) {\r\n            array.push(\"ms.errorcolno\", errorObject.colno);\r\n        }\r\n        return array;\r\n    };\r\n    var errorSubscriber = function (errorObject) {\r\n        try {\r\n            var tArray = formatErrorObjectToWedcsArray(errorObject);\r\n            if (tArray.length > 0) {\r\n                insight.processWEDCSCustomEventFromArray(tArray);\r\n            }\r\n        } catch (ex) {\r\n            if (window.console) {\r\n                console.error(ex.toString());\r\n            }\r\n        }\r\n    };\r\n    insight.subscribeErrors = function () {\r\n        var Errors = require(\"errors\");\r\n        Errors.subscribe(errorSubscriber);\r\n    };\r\n    ////////////////////// FOCUS EVENT\r\n    insight.firePageFocusEvent = function (type) {\r\n        insight.debugLog(\"stepped inside firePageFocusEvent function\");\r\n        var tArray = [];\r\n        tArray.push(\"ms.focuseventtime\", new Date().getTime());\r\n        tArray.push(\"ms.focusorblue\", type);\r\n        insight.processWEDCSCustomEventFromArray(tArray);\r\n    };\r\n    insight.setupPageFocusTracking = function () {\r\n\r\n        $(window).on(\"blur focus\", function (e) {\r\n            var prevType = $(this).data(\"prevType\");\r\n\r\n            if (prevType !== e.type) {   //reduce double fire issues\r\n                switch (e.type) {\r\n                    case \"blur\":\r\n                        insight.debugLog(\"Blured\");\r\n                        insight.firePageFocusEvent(\"Blured\");\r\n                        break;\r\n                    case \"focus\":\r\n                        insight.debugLog(\"Focused\");\r\n                        insight.firePageFocusEvent(\"Focused\");\r\n                        break;\r\n                }\r\n            }\r\n            $(this).data(\"prevType\", e.type);\r\n        });\r\n\r\n    };\r\n    ////////////////////// COPY EVENT\r\n    insight.fireCopyEvent = function (txt, length) {\r\n        insight.debugLog(\"stepped inside fireCopyEvent function\");\r\n        var tArray = [];\r\n        tArray.push(\"ms.copyeventtime\", new Date().getTime());\r\n        tArray.push(\"ms.copycontent\", txt);\r\n        tArray.push(\"ms.copycontentlength\", length);\r\n        insight.processWEDCSCustomEventFromArray(tArray);\r\n    };\r\n    insight.setupCopyTracking = function () {\r\n        $(window).bind(\"copy\", function (e) {\r\n            var txt = window.getSelection().toString();\r\n            var length = txt.length;\r\n            txt = txt.substring(0, 20); //truncate to limit the length of WEDCS event\r\n            insight.fireCopyEvent(txt, length);\r\n        });\r\n    };\r\n    ////////////////////// SWITCHER SELECTION\r\n    insight.fireSwitcherEvent = function (switcher, selectedValue) {\r\n        insight.debugLog(\"stepped inside fireSwitcherEvent function\");\r\n        var tArray = [];\r\n        tArray.push(\"ms.switcheventtime\", new Date().getTime());\r\n        tArray.push(\"ms.switcher\", switcher);\r\n        tArray.push(\"ms.switchervalue\", selectedValue);\r\n        insight.processWEDCSCustomEventFromArray(tArray);\r\n    };\r\n    insight.setupSwitcherTracking = function () {\r\n        $(\".menu-theme select\").change(function () {\r\n            var selectedValue = $(\".menu-theme select\").val();\r\n            insight.fireSwitcherEvent(\"theme\", selectedValue);\r\n        });\r\n        $('.menu-platform select').change(function () {\r\n            var selectedValue = $(\".menu-platform select\").val();\r\n            insight.fireSwitcherEvent(\"platform\", selectedValue);\r\n        });\r\n        $('.menu-lang select').change(function () {\r\n            var selectedValue = $(\".menu-lang select\").val();\r\n            insight.fireSwitcherEvent(\"lang\", selectedValue);\r\n        });\r\n    };\r\n    ////////////////////// SCROLL TRACKING\r\n    //Scroll Area definition\r\n    insight.scrollArea = function (inName) {\r\n        this.name = inName;\r\n        this.scrollNA = false;\r\n        this.scrollQuarter = false;\r\n        this.scrollHalf = false;\r\n        this.scrollThreeQuarter = false;\r\n        this.scrollBot = false;\r\n    };\r\n    //Track multiple scroll areas per page\r\n    insight.currScrollArea = null;\r\n    insight.scrollAreaList = [];\r\n\r\n    insight.setCurrScrollArea = function (inIndex) {\r\n        if (typeof inIndex !== \"number\") {\r\n            return;\r\n        } else if (insight.scrollAreaList.length <= inIndex) {\r\n            return;\r\n        }\r\n\r\n        insight.currScrollArea = insight.scrollAreaList[inIndex];\r\n    };\r\n\r\n    //Page dimension variables\r\n    insight.scrollBottomElement = null;\r\n    insight.scrollPageHeight = -1;\r\n    insight.viewportBottom = -1;\r\n    insight.refreshScrollPageDimVars = function () {\r\n        var tBottom = 0;\r\n        if (insight.scrollBottomElement) {\r\n            tBottom = insight.scrollBottomElement.getBoundingClientRect().top + window.pageYOffset;\r\n        }\r\n        if (tBottom <= 0) {\r\n            tBottom = document.body.getBoundingClientRect().height;\r\n        }\r\n        insight.scrollPageHeight = tBottom;\r\n        insight.viewportBottom = window.pageYOffset + window.innerHeight;\r\n    };\r\n    insight.suppressMobileEvents = false;\r\n    insight.fireScrollEvent = function (inScrollValue) {\r\n        insight.fireScrollEvent(inScrollValue, \"scroll\");\r\n    };\r\n    insight.fireScrollStopEvent = function (inScrollValue) {\r\n        insight.fireScrollEvent(inScrollValue, \"scroll-stop\");\r\n    };\r\n    insight.fireScrollEvent = function (inScrollValue, eventType) {\r\n        insight.debugLog(\"stepped inside fireScrollEvent function\");\r\n        var tArray = [];\r\n        tArray.push(\"ms.pgarea\", \"body\");\r\n        tArray.push(\"ms.scnum\", \"scroll-\" + inScrollValue);\r\n        tArray.push(\"ms.interactiontype\", \"4\");\r\n        tArray.push(\"ms.scn\", eventType);\r\n        insight.processWEDCSCustomEventFromArray(tArray);\r\n    };\r\n    insight.processScroll = function (stopEvent) {\r\n        window.clearTimeout(insight.scrollResizeTimer);\r\n        if (insight.currScrollArea === null) {\r\n            return;\r\n        }\r\n        insight.refreshScrollPageDimVars();\r\n        if (insight.scrollPageHeight <= 0) {\r\n            return;\r\n        } else if (insight.suppressMobileEvents && window.innerWidth <= 510) {\r\n            return;\r\n        }\r\n\r\n        var tCurrPercent = insight.viewportBottom / insight.scrollPageHeight;\r\n\r\n        if (stopEvent === true) {\r\n            insight.fireScrollStopEvent(Math.round(tCurrPercent * 100) + \"%\");\r\n            return;\r\n        }\r\n\r\n        if (window.innerHeight > insight.scrollPageHeight * 0.90) {\r\n            //Visitor can see the whole page, fire special -na event\r\n            if (!insight.currScrollArea.scrollNA) {\r\n                insight.currScrollArea.scrollNA = true;\r\n                insight.fireScrollEvent(\"na\");\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (tCurrPercent > 0.25 && !insight.currScrollArea.scrollQuarter) {\r\n            insight.currScrollArea.scrollQuarter = true;\r\n            insight.fireScrollEvent(\"25%\");\r\n        }\r\n        if (tCurrPercent > 0.50 && !insight.currScrollArea.scrollHalf) {\r\n            insight.currScrollArea.scrollHalf = true;\r\n            insight.fireScrollEvent(\"50%\");\r\n        }\r\n        if (tCurrPercent > 0.75 && !insight.currScrollArea.scrollThreeQuarter) {\r\n            insight.currScrollArea.scrollThreeQuarter = true;\r\n            insight.fireScrollEvent(\"75%\");\r\n        }\r\n        if (tCurrPercent > 0.99 && !insight.currScrollArea.scrollBot) {\r\n            insight.currScrollArea.scrollBot = true;\r\n            insight.fireScrollEvent(\"100%\");\r\n        }\r\n    };\r\n\r\n    insight.scrollTimer = null;\r\n    insight.scrollResizeTimer = 0;\r\n    insight.setupScrollTracking = function () {\r\n        insight.scrollBottomElement = $(\"#footer\")[0];\r\n\r\n        insight.scrollAreaList.push(new insight.scrollArea(\"body\"));\r\n        insight.setCurrScrollArea(0);\r\n\r\n        window.addEventListener(\"scroll\", function () {\r\n            insight.processScroll(false);\r\n        });\r\n\r\n        //catch scroll stop event (stop more than 10 seconds)\r\n        if (insight.scrollTimer !== null) {\r\n            window.clearTimeout(insight.scrollTimer);\r\n        }\r\n        insight.scrollTimer = window.setTimeout(function () {\r\n            insight.processScroll(true);\r\n        }, 1000 * 10);\r\n\r\n        //Note: resize also catches zoom in/out\r\n        $(window).resize(function () {\r\n            window.clearTimeout(insight.scrollResizeTimer);\r\n            insight.scrollResizeTimer = window.setTimeout(function () {\r\n                insight.processScroll(false);\r\n            }, 500);\r\n        });\r\n    };\r\n    insight.extractMetaFromAmbientContext = function () {\r\n        if (window.AmbientContext) {\r\n            for (var key in window.AmbientContext) {\r\n                if (window.AmbientContext.hasOwnProperty(key)) {\r\n                    var content = window.AmbientContext[key];\r\n                    if (content) {\r\n                        if (!(typeof(content) === \"string\" || content instanceof String)) {\r\n                            content = JSON.stringify(content);\r\n                        }\r\n                    }\r\n                    $(\"head\").append(\"<meta name='ms.\" + encodeURI(key.replace(\".\", \"_\")) +\r\n                        \"' content='\" + encodeURI(content) + \"' />\");\r\n                }\r\n            }\r\n        }\r\n    };\r\n    insight.setupPerfTiming = function () {\r\n        if (!window.performance || !window.performance.timing) {\r\n            return;\r\n        }\r\n        var navigationStart = window.performance.timing.navigationStart;\r\n        if (typeof navigationStart !== \"number\") {\r\n            return;\r\n        }\r\n        //Navigation timing attributes, ref: https://w3c.github.io/navigation-timing/\r\n        var keys = [\"redirectStart\", \"redirectEnd\", \"fetchStart\", \"connectStart\", \"connectEnd\", \"requestStart\", \"responseStart\",\r\n                    \"responseEnd\", \"domLoading\", \"domInteractive\", \"domContentLoadedEventStart\", \"domContentLoadedEventEnd\",\r\n                    \"domComplete\", \"loadEventStart\", \"loadEventEnd\"];\r\n        var timeInfoArr = [];\r\n        for (var index = 0; index < keys.length; index++) {\r\n            var key = keys[index];\r\n            if (typeof window.performance.timing[key] !== \"number\") {\r\n                timeInfoArr.push(\"\");\r\n            } else {\r\n                var elapsed = window.performance.timing[key] !== 0 ? window.performance.timing[key] - navigationStart : \"\";\r\n                timeInfoArr.push(elapsed);\r\n            }\r\n        }\r\n        $(\"head\").append(\"<meta name='ms.perf.timing' content='\" + timeInfoArr.join() + \"' />\");\r\n    };\r\n    insight.enableWEDCS = function () {\r\n        //WEDCS base settings\r\n        window.varClickTracking = 1;\r\n        window.varCustomerTracking = 0;\r\n        window.varAutoFirePV = 1;\r\n        window.route = \"\";\r\n        window.ctrl = \"\";\r\n\r\n        require([\"docs.config\"], function(config){\r\n            $script(config.paths.wedcs);\r\n        });\r\n    };\r\n\r\n    $(document).ready(function () {\r\n        try {\r\n            insight.subscribeErrors();\r\n            insight.extractMetaFromAmbientContext();\r\n            insight.setupPerfTiming();\r\n            insight.enableWEDCS();\r\n            insight.setupPageFocusTracking();\r\n            insight.setupScrollTracking();\r\n            insight.setupCopyTracking();\r\n            insight.setupSwitcherTracking();\r\n        } catch (ex) {\r\n            Trace.traceError(ex.toString());\r\n        }\r\n    });\r\n\r\n    window.insight = insight;\r\n})();\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./insight.js\n ** module id = 26\n ** module chunks = 1 5 7\n **/","define('trace', function () {\r\n    \"use strict\";\r\n\r\n    var TraceLevel = {\r\n        error: 1,\r\n        warning: 2,\r\n        information: 3\r\n    };\r\n\r\n    var TraceCategory = {\r\n        regular: 1,\r\n        performance: 2\r\n    };\r\n\r\n    var traceEntries = [];\r\n    var listeners = $.Callbacks();\r\n\r\n    var isBroadcasting = false;\r\n    function broadcast() {\r\n        if (isBroadcasting || !listeners.has()) {\r\n            return;\r\n        }\r\n\r\n        isBroadcasting = true;\r\n\r\n        try {\r\n            var entry = traceEntries.shift();\r\n            while (entry) {\r\n                listeners.fire(entry);\r\n                entry = traceEntries.shift();\r\n            }\r\n        } finally {\r\n            isBroadcasting = false;\r\n        }\r\n    }\r\n\r\n    function trace(category, level, message, dataObject) {\r\n        var entry = {\r\n            category: category || TraceCategory.regular,\r\n            level: level || TraceLevel.information,\r\n            message: message,\r\n            data: dataObject,\r\n            timeStamp: Date.now()\r\n        };\r\n\r\n        traceEntries.push(entry);\r\n        broadcast();\r\n    }\r\n\r\n    function traceError(message, dataObject) {\r\n        trace(TraceCategory.regular, TraceLevel.error, message, dataObject);\r\n    }\r\n\r\n    function traceWarning(message, dataObject) {\r\n        trace(TraceCategory.regular, TraceLevel.warning, message, dataObject);\r\n    }\r\n\r\n    function traceInfo(message, dataObject) {\r\n        trace(TraceCategory.regular, TraceLevel.information, message, dataObject);\r\n    }\r\n\r\n    var subscribe = function (callback) {\r\n        listeners.add(callback);\r\n        window.setTimeout(broadcast);\r\n    };\r\n\r\n    var unsubscribe = function (callback) {\r\n        listeners.remove(callback);\r\n    };\r\n\r\n    module.exports.TraceCategory = TraceCategory;\r\n    module.exports.TraceLevel = TraceLevel;\r\n    module.exports.subscribe = subscribe;\r\n    module.exports.unsubscribe = unsubscribe;\r\n    module.exports.trace = trace;\r\n    module.exports.traceError = traceError;\r\n    module.exports.traceWarning = traceWarning;\r\n    module.exports.traceInfo = traceInfo;\r\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./trace.js\n ** module id = 27\n ** module chunks = 1 5 7\n **/","define('errors', function () {\r\n    \"use strict\";\r\n\r\n    var pendingErrors = [];\r\n    var errorHandlers = $.Callbacks();\r\n\r\n    // avoid reentry\r\n    var isBroadcasting = false;\r\n    function broadcastErrors() {\r\n        if (isBroadcasting) {\r\n            return;\r\n        }\r\n\r\n        isBroadcasting = true;\r\n\r\n        try {\r\n            var errorObject = pendingErrors.shift();\r\n            while (errorObject) {\r\n                errorHandlers.fire(errorObject);\r\n                errorObject = pendingErrors.shift();\r\n            }\r\n        } finally {\r\n            isBroadcasting = false;\r\n        }\r\n    }\r\n\r\n    function handleError(errorObject) {\r\n        pendingErrors.push(errorObject);\r\n\r\n        if (!errorHandlers.has()) {\r\n            return;\r\n        }\r\n\r\n        broadcastErrors();\r\n    }\r\n\r\n    window.onerror = function (message, source, lineno, colno, error) {\r\n        var errorObject = {\r\n            isBubbled: false,\r\n            message: message,\r\n            source: source,\r\n            lineno: lineno,\r\n            colno: colno,\r\n            error: error\r\n        };\r\n\r\n        handleError(errorObject);\r\n    };\r\n\r\n    $(window).bind('error', function (event) {\r\n        var errorObject = {\r\n            isBubbled: true,\r\n            error: event.originalEvent || event\r\n        };\r\n\r\n        handleError(errorObject);\r\n    });\r\n\r\n    module.exports.subscribe = function (handler) {\r\n        errorHandlers.add(handler);\r\n        window.setTimeout(broadcastErrors);\r\n    };\r\n\r\n    module.exports.unsubscribe = function (handler) {\r\n        errorHandlers.remove(handler);\r\n    };\r\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./errors.js\n ** module id = 28\n ** module chunks = 1 5 7\n **/","// load openfeedback\r\nwindow.openFeedbackOptions = {\r\n    containerElementId: \"openFeedbackContainer\",\r\n    siteNameMetaName: \"ms.sitename\",\r\n    documentMetaName: \"ms.assetid\",\r\n    localeMetaName: \"ms.locale\"\r\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./rating.js\n ** module id = 29\n ** module chunks = 1 7\n **/"],"sourceRoot":""}